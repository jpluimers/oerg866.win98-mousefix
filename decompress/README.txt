This code is taken from patcher9x

(C) 2022 Jaroslav Hensl (JHRobotics)

https://github.com/JHRobotics/patcher9x

I have hacked it together to strip all the unneccessary bits for this patch and fix compilation for OpenWatcom